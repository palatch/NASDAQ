<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏∏‡πâ‡∏ô TSLA / TSLS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background: #0d1b2a;
      color: #e0e0e0;
      padding: 20px;
    }
    h1 {
      color: #00ffff;
      text-align: center;
      margin-bottom: 20px;
      text-shadow: 0 0 5px #00ffff;
    }
    .status-box {
      text-align: center;
      font-size: 1.2em;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .open { background: #004d40; color: #00ffcc; }
    .closed { background: #550000; color: #ff9999; }

    .box {
      padding: 15px;
      margin-top: 15px;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.4);
      box-shadow: 0 0 10px #000;
      border: 1px solid #555;
    }
    .buy { background: rgba(255, 0, 0, 0.2); color: #ff6666; }
    .sell { background: rgba(0, 255, 255, 0.2); color: #00e6e6; }
    .wait { background: rgba(255, 255, 0, 0.2); color: #ffcc00; }
    .status { font-weight: bold; font-size: 1.1em; margin-top: 10px; }
    .price { font-size: 1.2em; margin: 10px 0; }
    .graph-line {
      width: 100%;
      height: 1px;
      background: linear-gradient(to right, #00ffcc, transparent);
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>üìà ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏∏‡πâ‡∏ô TSLA ‡πÅ‡∏•‡∏∞ TSLS (‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏¥‡∏ß‡∏¢‡∏≠‡∏£‡πå‡∏Å)</h1>
  <div id="marketStatus" class="status-box">‚è≥ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏•‡∏≤‡∏î...</div>

  <div class="graph-line"></div>

  <div id="tslaBox" class="box">
    <h2>üìå TSLA</h2>
    <div id="tslaPrice" class="price">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤...</div>
    <div id="tslaSignal"></div>
    <div id="tslaBudget"></div>
  </div>

  <div class="graph-line"></div>

  <div id="tslsBox" class="box">
    <h2>üìå TSLS</h2>
    <div id="tslsPrice" class="price">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤...</div>
    <div id="tslsSignal"></div>
    <div id="tslsBudget"></div>
  </div>

  <script>
    const apiKey = "d24u9h9r01qu2jgk36cgd24u9h9r01qu2jgk36d0";
    const baseUrl = "https://finnhub.io/api/v1/quote?symbol=";

    function isMarketOpenNY() {
      const now = new Date();
      const options = { timeZone: 'America/New_York', hour: '2-digit', minute: '2-digit', weekday: 'short', hour12: false };
      const parts = new Intl.DateTimeFormat('en-US', options).formatToParts(now);
      let hour = 0, minute = 0, day = "";
      parts.forEach(p => {
        if (p.type === 'hour') hour = parseInt(p.value);
        if (p.type === 'minute') minute = parseInt(p.value);
        if (p.type === 'weekday') day = p.value;
      });

      const totalMins = hour * 60 + minute;
      const openMins = 9 * 60 + 30;
      const closeMins = 16 * 60;

      const marketStatus = document.getElementById("marketStatus");
      if (["Sat", "Sun"].includes(day) || totalMins < openMins || totalMins > closeMins) {
        marketStatus.className = "status-box closed";
        marketStatus.innerHTML = "‚ùå ‡∏ï‡∏•‡∏≤‡∏î‡∏õ‡∏¥‡∏î‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏¥‡∏ß‡∏¢‡∏≠‡∏£‡πå‡∏Å)";
      } else {
        marketStatus.className = "status-box open";
        marketStatus.innerHTML = "‚úÖ ‡∏ï‡∏•‡∏≤‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏¥‡∏ß‡∏¢‡∏≠‡∏£‡πå‡∏Å)";
      }
    }

    function fetchData(symbol, priceId, signalId, budgetId, buy, sell, gainPerUnit) {
      fetch(`${baseUrl}${symbol}&token=${apiKey}`)
        .then(response => response.json())
        .then(data => {
          const price = parseFloat(data.c);
          document.getElementById(priceId).innerHTML = `üíµ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <strong>$${price.toFixed(2)}</strong>`;

          let signal = "";
          if (price <= buy) {
            signal = `üî¥ ${symbol} ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ $${buy} ‚Üí <strong>‡∏Ñ‡∏ß‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!</strong>`;
            document.getElementById(signalId).className = "buy";
            alert(`üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ${symbol} ‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß!`);
          } else if (price >= sell) {
            signal = `üîµ ${symbol} ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ $${sell} ‚Üí <strong>‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!</strong>`;
            document.getElementById(signalId).className = "sell";
            alert(`üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ${symbol} ‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
          } else {
            signal = `‚è≥ ${symbol} ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á $${buy} ‚Äì $${sell} ‚Üí <strong>‡∏£‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞</strong>`;
            document.getElementById(signalId).className = "wait";
          }

          const units = Math.ceil(5 / gainPerUnit);
          const requiredBudget = (price * units).toFixed(2);
          document.getElementById(signalId).innerHTML = signal;
          document.getElementById(budgetId).innerHTML = `üí∞ ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ‚âà <strong>$${requiredBudget}</strong> (${units} ‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡πÑ‡∏£ ‚â• $5)`;
        })
        .catch(err => {
          document.getElementById(priceId).innerHTML = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        });
    }

    isMarketOpenNY();
    fetchData("TSLA", "tslaPrice", "tslaSignal", "tslaBudget", 310, 330, 20);
    fetchData("TSLS", "tslsPrice", "tslsSignal", "tslsBudget", 7.00, 9.50, 2.5);
  </script>
</body>
</html>
