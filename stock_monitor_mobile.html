
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô TP/SL + ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πà‡∏≤‡∏ß</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      margin: 0;
      background-color: #f9f9f9;
    }
    h2, h3 {
      text-align: center;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 12px;
      margin: 8px 0;
      width: 100%;
      box-sizing: border-box;
      font-size: 16px;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #eef;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
    }
    .stock-actions {
      margin-top: 5px;
    }
    .stock-actions button {
      background-color: #dc3545;
      margin-top: 5px;
    }
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      .container {
        padding: 10px;
      }
      input, button {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üìà ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</h2>
    <input type="text" id="symbolInput" placeholder="‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏´‡∏∏‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô AAPL" />
    <input type="number" id="buyPriceInput" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠" />
    <input type="number" id="tpInput" placeholder="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≥‡πÑ‡∏£ (TP)" />
    <input type="number" id="slInput" placeholder="‡∏à‡∏∏‡∏î‡∏ï‡∏±‡∏î‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô (SL)" />
    <button onclick="addStock()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏∏‡πâ‡∏ô</button>

    <h3>‚úÖ ‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß:</h3>
    <ul id="stockList"></ul>
  </div>

  <script>
    const API_KEY = 'd24u9h9r01qu2jgk36cgd24u9h9r01qu2jgk36d0';
    const API_ENDPOINT = 'https://finnhub.io/api/v1';
    const stockList = document.getElementById('stockList');

    function loadStocks() {
      const stocks = JSON.parse(localStorage.getItem('stocks') || '[]');
      stockList.innerHTML = '';
      stocks.forEach(stock => {
        const li = document.createElement('li');
        li.innerHTML = `
          <strong>${stock.symbol}</strong><br>
          ‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà ${stock.buyPrice} | TP: ${stock.tp} | SL: ${stock.sl}
          <div class="stock-actions">
            <button onclick="removeStock('${stock.symbol}')">üóëÔ∏è ‡∏•‡∏ö</button>
          </div>
        `;
        stockList.appendChild(li);
      });
    }

    function addStock() {
      const symbol = document.getElementById('symbolInput').value.trim().toUpperCase();
      const buyPrice = parseFloat(document.getElementById('buyPriceInput').value);
      const tp = parseFloat(document.getElementById('tpInput').value);
      const sl = parseFloat(document.getElementById('slInput').value);

      if (!symbol || isNaN(buyPrice) || isNaN(tp) || isNaN(sl)) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á');
        return;
      }

      let stocks = JSON.parse(localStorage.getItem('stocks') || '[]');
      stocks.push({ symbol, buyPrice, tp, sl });
      localStorage.setItem('stocks', JSON.stringify(stocks));

      document.getElementById('symbolInput').value = '';
      document.getElementById('buyPriceInput').value = '';
      document.getElementById('tpInput').value = '';
      document.getElementById('slInput').value = '';

      loadStocks();
    }

    function removeStock(symbol) {
      let stocks = JSON.parse(localStorage.getItem('stocks') || '[]');
      stocks = stocks.filter(stock => stock.symbol !== symbol);
      localStorage.setItem('stocks', JSON.stringify(stocks));
      loadStocks();
    }

    function checkAlerts() {
      const stocks = JSON.parse(localStorage.getItem('stocks') || '[]');
      stocks.forEach(stock => {
        fetch(`${API_ENDPOINT}/quote?symbol=${stock.symbol}&token=${API_KEY}`)
          .then(response => response.json())
          .then(data => {
            const currentPrice = data.c;
            if (currentPrice >= stock.tp) {
              alert(`üéØ ‡∏´‡∏∏‡πâ‡∏ô ${stock.symbol} ‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≥‡πÑ‡∏£‡πÅ‡∏•‡πâ‡∏ß! (${currentPrice} ‚â• ${stock.tp})`);
            } else if (currentPrice <= stock.sl) {
              alert(`‚ö†Ô∏è ‡∏´‡∏∏‡πâ‡∏ô ${stock.symbol} ‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ï‡∏±‡∏î‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô! (${currentPrice} ‚â§ ${stock.sl})`);
            }
          });

        fetch(`${API_ENDPOINT}/news-sentiment?symbol=${stock.symbol}&token=${API_KEY}`)
          .then(response => response.json())
          .then(data => {
            const sentiment = data.sentiment;
            if (!sentiment) return;

            const positive = sentiment.positiveScore;
            const negative = sentiment.negativeScore;

            if (positive > negative) {
              alert(`üìà ‡∏Ç‡πà‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á ${stock.symbol} ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô`);
            } else if (negative > positive) {
              alert(`üìâ ‡∏Ç‡πà‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á ${stock.symbol} ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏ö ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏•‡∏á`);
            } else {
              alert(`‚öñÔ∏è ‡∏Ç‡πà‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á ${stock.symbol} ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á`);
            }
          });

        fetch(`${API_ENDPOINT}/indicator?symbol=${stock.symbol}&resolution=D&indicator=rsi&token=${API_KEY}`)
          .then(res => res.json())
          .then(data => {
            const rsi = data?.rsi?.slice(-1)[0];
            if (rsi > 70) {
              alert(`üìâ RSI ‡∏Ç‡∏≠‡∏á ${stock.symbol} ‡∏™‡∏π‡∏á (${rsi}) ‡∏≠‡∏≤‡∏à‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏Ç‡∏≤‡∏¢`);
            } else if (rsi < 30) {
              alert(`üìà RSI ‡∏Ç‡∏≠‡∏á ${stock.symbol} ‡∏ï‡πà‡∏≥ (${rsi}) ‡∏≠‡∏≤‡∏à‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ã‡∏∑‡πâ‡∏≠`);
            }
          });
      });
    }

    loadStocks();
    checkAlerts();
    setInterval(checkAlerts, 60 * 60 * 1000);
  </script>
</body>
</html>
